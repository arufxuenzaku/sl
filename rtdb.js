import{initializeApp}from"https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js";import{getDatabase,ref,child,get,update}from"https://www.gstatic.com/firebasejs/9.18.0/firebase-database.js";const firebaseConfig={apiKey:"AIzaSyA2vVGK5q7CCIogSzjWmS3W1dwXWIaNx54",authDomain:"arlokastu.firebaseapp.com",databaseURL:"https://arlokastu-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"arlokastu",storageBucket:"arlokastu.appspot.com",messagingSenderId:"380938305623",appId:"1:380938305623:web:7e29194c2b17940611e312"},app=initializeApp(firebaseConfig),db=getDatabase(),fRtdb=async()=>{const t=sessionStorage.getItem("_shortL");if(t){let e=JSON.parse(t),a=`stu/${e.by}/${e.id}/`;if(await get(child(ref(db),a+"ori")).then((t=>!!t.exists()&&t.val()==e.ori)).catch((()=>!1))){let t=await get(child(ref(db),`userLevel/${e.by}/level`)).then((t=>t.exists()&&t.val())).catch((()=>!1));t&&(t=await get(child(ref(db),`config/stu/level/${t}/cpc`)).then((t=>t.exists()?t.val():1)));const c=await get(child(ref(db),"config/stu/cpc")).then((t=>t.exists()?t.val():1)),i=t||c,s=await get(child(ref(db),a+"click")).then((t=>t.exists()?t.val()+1:1)).catch((()=>1)),r=new Date,l=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),d=String(r.getDate()).padStart(2,"0"),p=[l,o].join("-"),n=await get(child(ref(db),`/reports/${e.by}/${p}/${d}`)).then((t=>{let e=t.val();return{click:e.click+1,cpc:(e.click*e.cpc+i)/(e.click+1)}})).catch((()=>({click:1,cpc:i}))),b=await get(child(ref(db),`/balance/${e.by}/current`)).then((t=>t.val()+i)).catch((()=>i)),f={};f["/"+a+"click"]=s,f[`/reports/${e.by}/${p}/${d}/click`]=n.click,f[`/reports/${e.by}/${p}/${d}/cpc`]=n.cpc,f[`/balance/${e.by}/current`]=b,console.info(f),document.querySelectorAll(".icdbx").forEach((t=>{t.addEventListener("click",(()=>{stVC()&&t.classList.contains("a")&&update(ref(db),f).then((()=>alert("Data successfully updated.."))).catch((t=>t.message))}))}))}}};fRtdb();
